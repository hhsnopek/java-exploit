function check(){resolved===count&&(normalize(),display())}function makeBar(e){for(var t="";e>t.length;)t+="=";return t}function normalize(){var e,t=0,n=0;for(e=0;count>e;e++)t=Math.max(t,outputs[e].gzip),n=Math.max(n,outputs[e].original);for(e=0;count>e;e++)outputs[e].bargraph=makeBar(80*(outputs[e].gzip/t)),outputs[e].bargraph2=makeBar(80*(outputs[e].original/n))}function display(){var e;for(e=0;count>e;e++)console.log(outputs[e].version+" "+outputs[e].gzip+" "+outputs[e].original),console.log("gzip "+outputs[e].bargraph),console.log("orig "+outputs[e].bargraph2);done()}function getSizeAtVersion(e,t){var n="",i={},r=https.request({host:"raw.github.com",port:443,path:"/timrwood/moment/"+e+t},function(t){t.setEncoding("utf8"),t.on("data",function(e){n+=e}),t.on("end",function(){zlib.gzip(n,function(t,r){i.version=e,i.gzip=r.length,i.original=n.length,resolved++,check()})})});r.on("error",function(e){console.log("problem with request: "+e.message)}),r.end(),count++,outputs.push(i)}function getRemote(){var e,t="1.0.1 1.1.0 1.1.1 1.1.2 1.2.0 1.3.0 1.4.0".split(" "),n="1.5.0 1.5.1 1.6.0 1.6.1 1.7.0 1.7.1".split(" ");for(e=0;t.length>e;e++)getSizeAtVersion(t[e],"/moment.min.js");for(e=0;n.length>e;e++)getSizeAtVersion(n[e],"/min/moment.min.js")}function getLocal(){count++;var e={};outputs.push(e),fs.readFile(path.normalize(__dirname+"/../min/moment.min.js"),"utf8",function(t,n){if(t)throw t;zlib.gzip(n,function(t,i){e.version=".next",e.gzip=i.length,e.original=n.length,resolved++,check()})})}var https=require("https"),zlib=require("zlib"),path=require("path"),fs=require("fs"),count=0,resolved=0,outputs=[],done;module.exports=function(e){e.registerTask("history","Check the codebase filesize over different releases.",function(){done=this.async(),getRemote(),getLocal()})};