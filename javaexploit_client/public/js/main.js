(function() {
  require.config({
    paths: {
      moment: "/components/moment/moment",
      jquery: "//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min"
    }
  });

  define(["moment", "jquery"], function(moment, $) {
    var checklastscrape, last_scrape;
    last_scrape = {};
    checklastscrape = function() {
      return $.ajax({
        cache: false,
        url: '/data/last_scrape_date.json',
        success: function(date) {
          $('#total').html("Total - " + date["cvetotal"]);
          return window.last_scrape = date;
        }
      });
    };
    setInterval(checklastscrape(), 600000);
    setInterval(function() {
      var duration, fullduration, i, list, _i, _ref;
      duration = moment.duration(moment().diff(+window.last_scrape["last_exploit_time"] * 1000));
      fullduration = "" + (duration.seconds()) + "s";
      list = ["" + (duration.days()) + "d", "" + (duration.hours()) + "h", "" + (duration.minutes()) + "m"];
      for (i = _i = 0, _ref = list.length; 0 <= _ref ? _i <= _ref : _i >= _ref; i = 0 <= _ref ? ++_i : --_i) {
        if (list[i][0] === '0') {
          list[i] = '';
        } else {
          break;
        }
      }
      fullduration = list.join(" ");
      return $('#time').html("" + fullduration + " " + (duration.seconds()) + "s");
    }, 1000);
    return $(document).ready($.ajax({
      url: '/data/datacollection.json',
      cache: false
    }).done(function(data) {
      var currentexploit, pastexploit;
      currentexploit = '000';
      pastexploit = '';
      if (pastexploit !== currentexploit) {
        pastexploit = data[1];
      }
      $('#exploit').html(pastexploit["name"]);
      $(function() {
        return $('#exploitinfo').append("<blockquote>" + pastexploit['info'] + "</blockquote>");
      });
      return $(function() {
        var i, _i, _ref, _results;
        _results = [];
        for (i = _i = 0, _ref = data.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {
          _results.push($('#cvelist').append("<ul><li class='name' id='" + data[i]["name"] + "'>" + data[i]["name"] + "</li><li>" + data[i]["info"] + "</li></ul>"));
        }
        return _results;
      });
    }));
  });

}).call(this);
