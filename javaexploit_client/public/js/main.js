(function() {
  require.config({
    paths: {
      moment: "/components/moment/moment",
      jquery: "http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min"
    }
  });

  define(["moment", "jquery"], function(moment, $) {
    setInterval(function() {
      return $.getJSON('/data/last_scrape_date.json', function(date) {
        var duration, fullduration, i, list, _i, _ref;

        duration = moment.duration(moment().diff(+date["last_exploit_time"] * 1000));
        fullduration = "" + (duration.seconds()) + "s";
        list = ["" + (duration.days()) + "d", "" + (duration.hours()) + "h", "" + (duration.minutes()) + "m"];
        for (i = _i = 0, _ref = list.length; 0 <= _ref ? _i <= _ref : _i >= _ref; i = 0 <= _ref ? ++_i : --_i) {
          if (list[i][0] === '0') {
            list[i] = '';
          } else {
            break;
          }
        }
        fullduration = list.join(" ");
        return $('#days').html("" + fullduration + " " + (duration.seconds()) + "s");
      });
    }, 1000);
    $.getJSON('/data/datacollection.json', function(data) {
      var currentexploit, pastexploit;

      currentexploit = "000";
      pastexploit = "";
      if (pastexploit !== currentexploit) {
        pastexploit = data[1];
      }
      $('#info').html(pastexploit["name"]);
      $(function() {
        return $('#exploitinfo').append("<blockquote>" + pastexploit['info'] + "</blockquote>");
      });
      return $(function() {
        var i, _i, _ref, _results;

        _results = [];
        for (i = _i = 0, _ref = data.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {
          _results.push($('#cvelist').append("<tr><td class='name'>" + data[i]["name"] + "</td><td>" + data[i]["info"] + "</td></tr>"));
        }
        return _results;
      });
    });
    $('#exploitbutton').click(function(event) {
      return $('#cvelist').toggle('show');
    });
    $('#mobilebutton').click(function(event) {
      return $('#cvelist').toggle('show');
    });
    return $('#info').click(function(event) {
      return $('#exploitinfo').toggle('show');
    });
  });

}).call(this);
